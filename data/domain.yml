# version: "3.0"

# intents:
#   - affirm
#   - deny
#   - greet
#   - thankyou
#   - goodbye
#   - search_concerts
#   - search_venues
#   - compare_reviews
#   - bot_challenge
#   - nlu_fallback
#   - how_to_get_started

# entities:
#   - name

# slots:
#   concerts:
#     type: list
#     influence_conversation: false
#     mappings:
#     - type: custom
#   venues:
#     type: list
#     influence_conversation: false
#     mappings:
#     - type: custom
#   likes_music:
#     type: bool
#     influence_conversation: true
#     mappings:
#     - type: custom

# responses:
#   utter_greet:
#     - text: "Hey there!"
#   utter_goodbye:
#     - text: "Goodbye :("
#   utter_default:
#     - text: "Sorry, I didn't get that, can you rephrase?"
#   utter_youarewelcome:
#     - text: "You're very welcome."
#   utter_iamabot:
#     - text: "I am a bot, powered by Rasa."
#   utter_get_started:
#     - text: "I can help you find concerts and venues. Do you like music?"
#   utter_awesome:
#     - text: "Awesome! You can ask me things like \"Find me some concerts\" or \"What's a good venue\""

# actions:
#   - action_search_concerts
#   - action_search_venues
#   - action_show_concert_reviews
#   - action_show_venue_reviews
#   - action_set_music_preference

# session_config:
#   session_expiration_time: 60  # value in minutes
#   carry_over_slots_to_new_session: true

version: "3.0"

intents:
  - greet
  - goodbye
  - affirm
  - deny
  - extract_kpi
  # - change_place
  # - change_time
  # - change_kpi
  - mood_unhappy
  - bot_challenge
  - chatbot_service
  - request_kpi_form


entities:
- place
- kpi
- time
slots: 
  place:
    type: text
    influence_conversation: true
    mappings:
    - type: from_entity
      entity: place
      # conditions:
      # - active_loop: kpi_form
      #   requested_slot: place   
  kpi:
    type: text
    influence_conversation: true
    mappings:
    - type: from_entity
      entity: kpi
      # conditions:
      # - active_loop: kpi_form
      #   requested_slot: kpi
  time: 
    type: text
    influence_conversation: true
    mappings:
    - type: from_entity
      entity: time
      # conditions:
      # - active_loop: kpi_form
      #   requested_slot: time
  confirm:
    type: bool
    influence_conversation: true
    mappings:
    - type: from_intent
      intent: affirm
      value: true
    - type: from_intent
      intent: deny
      value: false
forms:
  kpi_form:
    required_slots:
      - place
      - kpi
      - time


responses:
  utter_ask_place:
  - text: "Which place are you interested in?"

  utter_ask_kpi:
  - text: "Which KPI are you interested in?"

  utter_ask_time:
  - text: "What time are you interested?"

  utter_state_sql:
  - text: "SELECT SUM({kpi}) FROM \"E-Mobility\".emo_historical WHERE state='{place}' AND month={time};"

  utter_state_city_sql:
  - text: "SELECT {kpi} FROM \"E-Mobility\".emo_historical WHERE state='{place}' AND month={time};"

  utter_county_sql:
  - text: "SELECT {kpi} FROM \"E-Mobility\".emo_historical WHERE county='{place}' AND month={time};"

  utter_query_received:
  - text: "Ok, query received. Please confirm the following."

  utter_query_confirm:
  - text: "the place is {place}, kpi is {kpi}, time is {time}"

  utter_query_completed:
  - text: "Query now in process..."

  utter_ask_for_clarification:
  - text: "Please correct the false part."
  
  utter_greet:
  - text: "hi"

  utter_cheer_up:
  - text: "Here is something to cheer you up:"
    image: "https://media-cdn.tripadvisor.com/media/photo-s/11/a7/72/0f/vegetarian-menu.jpg"

  utter_service_1:
  - text: "KPIs that are available: Locations, Charging stations, Charging points, Charging points per 1,000 cars, Cars per charging point, Percentage of target."
  utter_service_2:
  - text: "You can type the KPI name for the KPI description or start directly asking me questions regarding the KPI within Germany."

  utter_did_that_help:
  - text: "Did that help you?"

  utter_happy:
  - text: "Great, carry on!"

  utter_goodbye:
  - text: "Bye"

  utter_iamabot:
  - text: "I am a bot, powered by Rasa."

actions:
  - utter_ask_place
  - utter_ask_time
  - utter_ask_kpi
  - action_query_clarify
  - action_reset_slots
  - action_query_confirm
  - action_execute_query
#   - validate_kpi_form

session_config:
  session_expiration_time: 60
  carry_over_slots_to_new_session: true
