version: "3.1"

intents:
  - KPI_query
  # - co_reference
  - coreference_radius
  - coreference_address
  - change_slot
  - choose_service
  - nearby_search
  - main_menu
  - continue
  - affirm
  - deny
  - faqs
  - greet
  - goodbye
  - out_of_scope
  - welcome_message
  - give_faqs
  


entities:
- place:
    influence_conversation: false
- kpi:
    influence_conversation: false
- time:
    influence_conversation: false
- max:
    influence_conversation: false
- min:
    influence_conversation: false
- avg:
    influence_conversation: false
- address:
    influence_conversation: false
- radius:
    influence_conversation: false
- charger_type:
    influence_conversation: false
- operator:
    influence_conversation: false
- increase:
    influence_conversation: false
- identifier_faqs:
    influence_conversation: false
- geo_level:
    influence_conversation: false
- service:
    influence_conversation: true

slots:
  place:
    type: list
    influence_conversation: false
    mappings:
    - type: from_entity
      entity: place
  kpi:
    type: text
    influence_conversation: false
    mappings:
    - type: from_entity
      entity: kpi
  time:
    type: list
    influence_conversation: false
    mappings:
    - type: from_entity
      entity: time
  charger_type:
    type: text
    influence_conversation: false
    mappings:
    - type: from_entity
      entity: charger_type
  operator:
    type: text
    influence_conversation: false
    mappings:
    - type: from_entity
      entity: operator 
  max:
    type: text
    influence_conversation: false
    mappings:
    - type: from_entity
      entity: max
  min:
    type: text
    influence_conversation: false
    mappings:
    - type: from_entity
      entity: min
  avg:
    type: text
    influence_conversation: false
    mappings:
    - type: from_entity
      entity: avg
  geo_level:
    type: text
    influence_conversation: false
    mappings:
    - type: from_entity
      entity: geo_level
  increase:
    type: text
    influence_conversation: false
    mappings:
    - type: from_entity
      entity: increase
  mapped_time: 
    type: text
    mappings:
    - type: custom
  stored_slots:
    type: any
    mappings:
    - type: custom
  faqs_q:
    type: text
    influence_conversation: false
    mappings:
    - type: from_text
      conditions:
      - active_loop: add_faqs_form
        requested_slot: faqs_q  
  faqs_a:
    type: text
    influence_conversation: false
    mappings:
    - type: from_text
      conditions:
      - active_loop: add_faqs_form
        requested_slot: faqs_a  
  address:
    type: text
    mappings:
    - type: from_text
      # intent: coreference_address
      conditions:
      - active_loop: nearby_search_form
        requested_slot: address
      # - active_loop: nearest_search_form
      #   requested_slot: address
  radius:
    type: text
    mappings:
    - type: from_text
      # intent: coreference_radius
      conditions:
      - active_loop: nearby_search_form
        requested_slot: radius
  service:
    type: categorical
    values:
      - 0
      - 1
      - 2
      - 3
      - 4
    influence_conversation: true
    mappings:
    - type: from_entity
      entity: service
  q_type:
    type: text
    influence_conversation: false
    mappings:
    - type: custom
  identifier_faqs:
    type: bool
    influence_conversation: true
    mappings:
    - type: from_entity
      entity: identifier_faqs
  query:
    type: text
    influence_conversation: false
    mappings:
    - type: custom
forms:
  kpi_form:
    required_slots:
      - time
  
  nearby_search_form:
    required_slots:
      - address
      - radius
  add_faqs_form:
    required_slots:
      - faqs_q
      - faqs_a

responses:
  utter_ask_place:
    - text: "Which place are you interested in? You can enter name of a federal state/city or simply 'county' or 'federal state'."

  utter_ask_time:
    - text: "What time are you interested in? Please enter a month using the format 'January 2022'."

  utter_ask_kpi:
    - text: "Which KPI are you interested in? Please choose one from the KPI listed above."

  utter_kpi_query:
    - text: "What's your query?"

  utter_query_received:
    - text: "I received your query! Please confirm the following."

  utter_query_completed:
    - text: "Query now in process..."

  utter_ask_for_clarification:
    - text: "Please correct the false part using the format '[name]: xxx', e.g. if you want to change place, you can type 'place: Berlin'."

  utter_faqs:
    - text: "What do you want to know more about E-Mobility?"

  utter_out_of_scope:
    - text: "Oops, I am stumped..."

  utter_ask_rephrase:
    - text: "Sorry, could you rephrase that?"

  utter_default:
    - text: "I'm sorry, I can't help you. You can type 0 to go back to the main menu and start asking again."
  
  utter_sorry:
    - text: "What else can I help you?"

  utter_greet:
    - text: "hello"

  utter_goodbye:
    - text: "goodbye!"

  utter_welcome:
    - text: "Hi, it's E-Mobility chatbot hereðŸ‘‹ Let me help you with E-Mobility questionsðŸ˜ƒ"

  utter_main_menu:
    - text: "What do you want to do? ðŸ˜ƒ"
      buttons:
      - title: "KPI query"
        payload: '/choose_service{{"service":1}}'
      - title: "Nearby Search"
        payload: '/choose_service{{"service":2}}'
      - title: "E-Mobility FAQs"
        payload: '/choose_service{{"service":3}}'
      - title: "Help"
        payload: '/choose_service{{"service":4}}'

  utter_help:
    - text: "See the details of each service below:  \n
            1.'KPI query': Query the KPI value.  \n
            2.'Nearby Search': Find charging stations within a radius around a given place.  \n           
            3.'E-Mobility FAQs': Introduce facts about emobility in the form of FAQs  \n
            4.'Help': Details of all the services.  \n
            0.'Main menu': Back to main menu."

  utter_thanks_quiz:
    - text: "Thank you!ðŸ˜€"

actions:
  - utter_ask_place
  - utter_ask_time
  - action_ask_address
  - action_ask_radius
  - action_ask_faqs_a
  - action_ask_faqs_q
  - action_execute_kpi_query
  - validate_kpi_form
  - action_check_coref
  - action_store_slots
  - action_reset_slots_except_stored
  - action_set_stored
  - action_two_stage_fallback
  - action_nearby_search
  - action_nearby_search_start
  - action_service_mapping
  - action_kpi_list
  - action_custom_slot_mapping
  - action_add_faqs_finished
  - action_give_faqs_finished
  - action_continue_options
  - action_reset_slots_except_service
  - action_query_classification
  - action_change_slot
  - action_restart
  - action_query_confirm


session_config:
  session_expiration_time: 60
  carry_over_slots_to_new_session: true
